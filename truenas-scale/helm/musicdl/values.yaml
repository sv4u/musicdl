# Default values for musicdl
# This is a YAML-formatted file.
# Note: This chart uses a Job resource for run-once execution, not a Deployment.

image:
  repository: musicdl
  tag: latest
  pullPolicy: IfNotPresent

imagePullSecrets: []
nameOverride: ""
fullnameOverride: ""

# Service account for the pod
serviceAccount:
  create: false
  annotations: {}
  name: ""

# Pod security context
podSecurityContext:
  fsGroup: 1000
  runAsNonRoot: true
  runAsUser: 1000

# Container security context
securityContext:
  allowPrivilegeEscalation: false
  capabilities:
    drop:
    - ALL
  readOnlyRootFilesystem: false

# Resource limits and requests
resources:
  limits:
    cpu: 2
    memory: 2Gi
  requests:
    cpu: 1
    memory: 1Gi

# Volume mounts
volumes:
  # Download directory - REQUIRED
  download:
    enabled: true
    # Path on TrueNAS Scale host
    hostPath: /mnt/pool/datasets/music
    # Mount path in container
    mountPath: /download
    # Access mode: ReadWriteOnce, ReadWriteMany, ReadOnlyMany
    accessMode: ReadWriteOnce
  
  # Optional: Override config file
  config:
    enabled: false
    hostPath: /mnt/pool/datasets/musicdl/config.yaml
    mountPath: /scripts/config.yaml
    accessMode: ReadOnlyMany
    subPath: ""

# Environment variables
env:
  CONFIG_PATH: /scripts/config.yaml

# Node selector for scheduling
nodeSelector: {}

# Tolerations for node scheduling
tolerations: []

# Affinity rules
affinity: {}

# Pod annotations
podAnnotations: {}

# Pod labels
podLabels: {}

# Job-specific settings
job:
  # Number of successful completions required (default: 1)
  completions: 1
  # Number of parallel pods (default: 1)
  parallelism: 1
  # Number of retries before marking job as failed (default: 3)
  backoffLimit: 3
  # Maximum time in seconds a job can run (optional, unset = no limit)
  activeDeadlineSeconds: null
  # Time in seconds to keep completed/failed jobs before deletion (optional)
  # Recommended: 3600 (1 hour) to allow log inspection
  ttlSecondsAfterFinished: 3600

# Container command override (optional)
command: []
args: []

